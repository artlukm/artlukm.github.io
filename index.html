<!DOCTYPE html> 
<html> 
    <head>  
        <meta http-equiv="Content-Type" content="text/html;
        charset=utf-8" /> 
        <meta name="description" conteent="STM32 FATFS remount SD card bug " />
        <meta name="keywords" content="STM32, FATFS, SD card, FR_DISK_ERR" />
        <meta name="yandex-verification" content="2b652bb9fd52a0b8" />
        <meta name="google-site-verification" content="ccRM1BQoC0q6aD3LBW2wjfptTopqifYCORU8LQ1ZAwg" />
        <meta name="viewport" content="width=device-widht, initial-scale=1">
        <link href="https://github.com/engaziwayo/engaziwayo.github.io/blob/main/img/pic.png?raw=true" rel="shortcut icon" type="image/x-icon" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">  
        <link rel="stylesheet" href="https://getbootstrap.com/docs/5.3/examples/cover/cover.css">
        <link rel="stylesheet" href="css/style.css">   
    </head>
        <body class="d-flex h-100 text-center text-bg-dark ">    <!-- text-center text-bg-dark -->
            <div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
                <header class="mb-auto">
                <div>
                    <h3 class="float-md-start mb-0">STM32 FATFS SD card</h3>
                    <nav class="nav nav-masthead justify-content-center float-md-end">
                    <a class="nav-link fw-bold py-1 px-0 active" aria-current="page" href="/">Home</a>
                    <a class="nav-link fw-bold py-1 px-0" href="/">Plug 1</a>
                    <a class="nav-link fw-bold py-1 px-0" href="/create">Plug 2</a>
                    </nav>
                </div>
                </header>


                
    <main class="px-3">
    <h1> <br> Present to your attention the bug FATFS of re-mounting the SD card. <br> <br> </h1>
    <p class="lead">
        <article>
            <p>
                If your code works fine, but after reinstalling the SD card,
                it no longer works, most likely you are facing the this problem.
                When reinserting the card. Function <i>f_mount()</i> no longer works, returns an error FR_DISK_ERR.
                to solve the problem, you need to add the function of zeroing the structure field in <i>diskio.c</i>.
             </p>

            <pre align="left">
            <br>
             void disk_DeInitialize (
                BYTE pdrv	/* Physical drive nmuber to identify the drive */
            )
            {
                disk.is_initialized[pdrv] = 0;
            }
            </pre>

            <br>
            <p>Add this function to f_mount, to call it when unmounting a disk. 
            <p>See the project code on <a href="https://github.com/RomanYankov/STM32_FATFS_SDcard_remount" style="color:rgb(117, 108, 244)">github</a>
            </p>

            <br>
            <p>Tutorial: SD card over SPI using STM32CubeIDE and FatFS
            <a href="https://01001000.xyz/2020-08-09-Tutorial-STM32CubeIDE-SD-card/" style="color:rgb(117, 108, 244)">Reference </a> 
            </p>
        </article>
        
        </p>
        
    <p class="lead">
        <a href="#" class="btn btn-lg btn-light fw-bold border-white bg-white">Click</a>
    </p>
    </main>

    <footer class="mt-auto text-white-50">
        <p>Cover template for <a href="https://getbootstrap.com/" class="text-white">Bootstrap</a>, by <a href="https://twitter.com/mdo" class="text-white">@mdo</a>.</p>
        </footer>
    </div>         
    
    
    </body>
    
    </html> 